(this.webpackJsonptash=this.webpackJsonptash||[]).push([[0],{88:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);var r,c=n(0),a=n(33),i=n.n(a),s=n(9),o=n(39),u=n(19),l=n(24),j=n(4),p=n(98),b=n(99);!function(e){e.VIEW="VIEW",e.ZOOM="ZOOM"}(r||(r={}));var d,f=function(e){var t=[],n=e.user.photos.map((function(e){return"video"===e.media_type?{type:"video",url:e.processedVideos[0].url,thumb:e.url}:{type:"image",url:e.url}}));if(e.experiment_info||e.user.user_interests){var r=e.experiment_info?e.experiment_info.user_interests:e.user.user_interests;t.push.apply(t,Object(l.a)(r.selected_interests.map((function(e){return e.name}))))}if(e.instagram&&e.instagram.photos||e.user.instagram&&e.user.instagram.photos){var c=e.instagram?e.instagram.photos:e.user.instagram.photos;n.push.apply(n,Object(l.a)(c.map((function(e){return{type:"image",url:e.image}}))))}return{id:e.user._id,distance:(e.distance_mi||1.609*e.user.distance_mi).toFixed(1),sNumber:e.s_number||e.user.s_number,bio:e.user.bio,gender:e.user.gender,name:e.user.name,active:e.user.recently_active||!1,birthDate:(new Date).getFullYear()-parseInt(e.user.birth_date.substr(0,4),10),interests:t,medias:n}},O={logged:!1,user:{likesRemaining:0,ageFilterMax:0,ageFilterMin:0,pictures:[],name:""},profiles:[],stats:{showing:0,duplicates:0},viewer:{open:!1,mode:r.VIEW},likes:[],dislikes:[]},h=Object(p.a)({INIT:function(e){return{likesRemaining:e.likes.likes_remaining,ageFilterMax:e.user.age_filter_max,ageFilterMin:e.user.age_filter_min,pictures:e.user.photos.map((function(e){return e.url})),name:e.user.name}},PUSH:function(e){return e.map(f)},OPEN_VIEWER:function(){return null},CLOSE_VIEWER:function(){return null},CHANGE_VIEWER_MODE:function(e){return e},RESET_VIEWER:function(){return null},PUSH_LIKE:function(e){return e},PUSH_DISLIKE:function(e){return e}}),m=Object(b.a)((d={},Object(u.a)(d,h.init.toString(),(function(e,t){return Object(j.a)(Object(j.a)({},e),{},{user:t.payload,logged:!0})})),Object(u.a)(d,h.push.toString(),(function(e,t){var n=e.profiles.map((function(e){return e.id})),r=t.payload.filter((function(e){return-1===n.indexOf(e.id)}));return Object(j.a)(Object(j.a)({},e),{},{profiles:[].concat(Object(l.a)(e.profiles),Object(l.a)(r)),stats:{showing:e.profiles.length+r.length,duplicates:e.stats.duplicates+(t.payload.length-r.length)}})})),Object(u.a)(d,h.openViewer.toString(),(function(e){return Object(j.a)(Object(j.a)({},e),{},{viewer:Object(j.a)(Object(j.a)({},e.viewer),{},{open:!0})})})),Object(u.a)(d,h.closeViewer.toString(),(function(e){return Object(j.a)(Object(j.a)({},e),{},{viewer:{open:!1,mode:r.VIEW}})})),Object(u.a)(d,h.changeViewerMode.toString(),(function(e,t){return Object(j.a)(Object(j.a)({},e),{},{viewer:Object(j.a)(Object(j.a)({},e.viewer),{},{mode:t.payload})})})),Object(u.a)(d,h.resetViewer.toString(),(function(e){return Object(j.a)(Object(j.a)({},e),{},{viewer:Object(j.a)(Object(j.a)({},e.viewer),{},{mode:r.VIEW})})})),Object(u.a)(d,h.pushLike.toString(),(function(e,t){return Object(j.a)(Object(j.a)({},e),{},{likes:[].concat(Object(l.a)(e.likes),[t.payload])})})),Object(u.a)(d,h.pushDislike.toString(),(function(e,t){return Object(j.a)(Object(j.a)({},e),{},{dislikes:[].concat(Object(l.a)(e.dislikes),[t.payload])})})),d),O),v=Object(o.a)({appReducer:m}),x=Object(o.c)(v,{},Object(o.b)(window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__():function(e){return e})),g=n(13),w=n(6),k=n.n(w),E=n(5),_=function(){var e=Object(E.f)();return{logout:function(){"/login"!==e.location.pathname&&(window.localStorage.removeItem("tashAppToken"),e.push("/login?redirectTo=".concat(encodeURIComponent(e.location.pathname))))}}},N=n(44),S=n.n(N),y=S.a.create({baseURL:"http://".concat("localhost"===window.location.hostname?"localhost":"cast.celiorodrigues.com",":6382"),transformRequest:[].concat(Object(l.a)(S.a.defaults.transformRequest),[function(e,t){return!t["tash-app-token"]&&window.localStorage.getItem("tashAppToken")&&(t["tash-app-token"]=window.localStorage.getItem("tashAppToken")),e}])}),I=n(8),R=n(7),V=n(38),M=n(20),D=(n(88),n(1)),T=function(){var e=Object(s.c)((function(e){return e.appReducer.viewer})),t=Object(s.b)();return Object(D.jsx)("div",{className:"sidebar",children:Object(D.jsxs)("ul",{children:[Object(D.jsx)("li",{children:Object(D.jsx)(M.c,{to:"/home",children:Object(D.jsx)(R.a,{icon:I.e})})}),Object(D.jsx)("li",{children:Object(D.jsx)(M.c,{to:"/likes",children:Object(D.jsx)(R.a,{icon:I.f})})}),e.open&&Object(D.jsx)("li",{children:Object(D.jsx)("a",{href:"#/",onClick:function(n){n.preventDefault(),t(h.changeViewerMode(e.mode===r.ZOOM?r.VIEW:r.ZOOM))},className:Object(V.a)({zoomActive:e.mode===r.ZOOM}),children:Object(D.jsx)(R.a,{icon:I.h})})})]})})},C=n(18),L=(n(90),function(e){var t=e.profile,n=e.visible,a=e.onClose,i=Object(s.c)((function(e){return e.appReducer.viewer})),o=Object(c.useState)(0),u=Object(C.a)(o,2),l=u[0],j=u[1],p=Object(s.b)(),b=Object(c.useState)(1),d=Object(C.a)(b,2),f=d[0],O=d[1],m=Object(c.useState)([0,0]),v=Object(C.a)(m,2),x=v[0],g=v[1],w=Object(c.useRef)(!1),k=Object(c.useRef)({x:0,y:0,tX:0,tY:0});Object(c.useEffect)((function(){p(h.resetViewer()),E()}),[l]),Object(c.useEffect)((function(){var e;return i.mode===r.ZOOM?n&&(e=document.querySelector(".viewer .preview"))&&e.addEventListener("mousewheel",_,!1):i.mode===r.VIEW&&E(),function(){e&&e.removeEventListener("mousewheel",_)}}),[i.mode]);var E=function(){O(1),g([0,0]),w.current=!1,k.current={x:0,y:0,tX:0,tY:0}},_=function(e){e.deltaY>0?O((function(e){return e>1?e-.1:e})):O((function(e){return e+.1}))},N=function(e){return j(e)};return n?Object(D.jsxs)("div",{className:"viewer",children:[Object(D.jsxs)("div",{className:"preview",onMouseMove:function(e){if(w.current){var t=e.pageX-70,n=e.pageY,r=k.current.x-t,c=k.current.y-n,a=[k.current.tX+r,k.current.tY+c];g(a)}},onMouseUp:function(e){e.preventDefault(),w.current?w.current=!1:"IMG"!==e.target.tagName&&a()},children:[Object(D.jsx)("button",{className:"prev",onMouseUp:function(e){e.preventDefault(),e.stopPropagation(),j((function(e){return 0===l?t.medias.length-1:e-1}))},children:Object(D.jsx)(R.a,{icon:I.b})}),"video"===t.medias[l].type?Object(D.jsx)("video",{autoPlay:!0,loop:!0,controls:!0,children:Object(D.jsx)("source",{type:"video/mp4",src:t.medias[l].url})},t.medias[l].url):Object(D.jsx)("img",{alt:"",src:t.medias[l].url,style:{transform:"scale(".concat(f,") translate(").concat(x[0],"px, ").concat(x[1],"px)")},onMouseDown:function(e){e.preventDefault();var t=document.querySelector(".viewer .preview");i.mode===r.ZOOM&&t&&(w.current=!0,g((function(t){return k.current={x:e.pageX-70,y:e.pageY,tX:t[0],tY:t[1]},t})))}}),Object(D.jsx)("button",{className:"next",onMouseUp:function(e){e.preventDefault(),e.stopPropagation(),j((function(e){return l===t.medias.length-1?0:e+1}))},children:Object(D.jsx)(R.a,{icon:I.c})})]}),Object(D.jsxs)("div",{className:"info",children:[Object(D.jsx)("button",{className:"close",onClick:a,children:Object(D.jsx)(R.a,{icon:I.j})}),Object(D.jsx)(M.b,{className:"share",to:"/share/".concat(t.id),target:"_blank",children:Object(D.jsx)(R.a,{icon:I.i})}),Object(D.jsxs)("h1",{children:[t.name,", ",t.birthDate]}),Object(D.jsxs)("span",{className:"distance",children:[t.distance," km"]}),Object(D.jsx)("p",{children:t.bio}),Object(D.jsx)("div",{className:"gallery",children:t.medias.map((function(e,t){var n=e.thumb||e.url;return Object(D.jsxs)("div",{className:Object(V.a)({active:t===l}),onClick:N.bind(null,t),children:[Object(D.jsx)("img",{src:n,alt:""}),"video"===e.type&&Object(D.jsx)("span",{className:"video",children:Object(D.jsx)(R.a,{icon:I.g,className:"video-icon"})})]},n)}))})]})]}):null}),F=(n(91),function(e){var t=e.profile,n=e.liked,r=e.disliked,a=Object(s.b)(),i=_(),o=Object(c.useState)(!1),u=Object(C.a)(o,2),l=u[0],j=u[1],p=function(){var e=Object(g.a)(k.a.mark((function e(n){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.stopPropagation(),e.prev=1,e.next=4,y.post("/like",{id:t.id,s:t.sNumber});case 4:200===e.sent.status&&a(h.pushLike(t.id)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),i.logout();case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(g.a)(k.a.mark((function e(n){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.stopPropagation(),e.prev=1,e.next=4,y.post("/dislike",{id:t.id,s:t.sNumber});case 4:200===e.sent.status&&a(h.pushDislike(t.id)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),i.logout();case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)("div",{className:"profile",onClick:function(){j(!0),a(h.openViewer())},children:[Object(D.jsx)("img",{src:function(){for(var e=0,n=t.medias[e];"video"===n.type;)e++,n=t.medias[e];return n.url}(),alt:""}),Object(D.jsxs)("div",{className:"info",children:[Object(D.jsxs)("h2",{children:[t.name,", ",t.birthDate]}),Object(D.jsxs)("div",{className:"actions",children:[!n&&Object(D.jsx)("button",{className:"dislike",onClick:b,children:Object(D.jsx)(R.a,{icon:I.j})}),!r&&Object(D.jsx)("button",{className:"like",onClick:p,children:Object(D.jsx)(R.a,{icon:I.f})})]})]})]}),Object(D.jsx)(L,{profile:t,visible:l,onClose:function(){j(!1),a(h.closeViewer())},onShare:function(){return window.open("/share/".concat(t.id),"_blank")}})]})}),P=(n(92),function(){var e=Object(s.c)((function(e){return e.appReducer})),t=e.profiles,n=e.likes,r=e.dislikes,a=Object(s.b)(),i=_(),o=Object(c.useRef)(!0);Object(c.useEffect)((function(){l();var e=document.querySelector(".profiles");return e&&e.addEventListener("scroll",u,!1),function(){e&&e.removeEventListener("scroll",u)}}),[]);var u=function(e){!o.current&&e.target.scrollHeight-e.target.scrollTop<e.target.clientHeight+40&&l()},l=function(){var e=Object(g.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o.current=!0,e.next=4,y.get("/profiles").then((function(e){return e.data.results}));case 4:t=e.sent,a(h.push(t)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),i.logout();case 11:o.current=!1;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(D.jsxs)("div",{className:"profiles",children:[t.map((function(e){return Object(D.jsx)(F,{profile:e,liked:-1!==n.indexOf(e.id),disliked:-1!==r.indexOf(e.id)},e.id)})),o.current&&Object(D.jsx)("div",{className:"loading",children:Object(D.jsx)(R.a,{icon:I.d,spin:!0})})]})}),U=(n(93),function(){var e=Object(c.useState)([]),t=Object(C.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),i=Object(C.a)(a,2),s=i[0],o=i[1],u=_();Object(c.useEffect)((function(){l()}),[]);var l=function(){var e=Object(g.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o(!0),e.next=4,y.get("/likes").then((function(e){return e.data.results}));case 4:t=e.sent,r(t.map((function(e){return e.user.photos[0].url}))),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),u.logout();case 11:o(!1);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(D.jsxs)("div",{className:"likes",children:[n.map((function(e){return Object(D.jsx)("div",{className:"like",children:Object(D.jsx)("img",{src:e,alt:""})},e)})),s&&Object(D.jsx)("div",{className:"loading",children:Object(D.jsx)(R.a,{icon:I.d,spin:!0})})]})}),W=(n(94),function(){var e=Object(c.useRef)(null),t=Object(s.b)(),n=Object(E.f)(),r=function(){var e=new URLSearchParams(n.location.search).get("redirectTo");n.push(e||"/home")},a=function(){var n=Object(g.a)(k.a.mark((function n(){var c;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.current||!e.current.value){n.next=13;break}return n.prev=1,n.next=4,y.get("/me",{headers:{"tash-app-token":e.current.value}});case 4:c=n.sent,window.localStorage.setItem("tashAppToken",e.current.value),t(h.init(c.data)),r(),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),alert("Invalid");case 13:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(){return n.apply(this,arguments)}}();return Object(D.jsx)("div",{className:"login-page",children:Object(D.jsxs)("div",{className:"box",children:[Object(D.jsx)("h1",{children:"TASH"}),Object(D.jsxs)("div",{className:"auth",children:[Object(D.jsx)("input",{ref:e,name:"token"}),Object(D.jsx)("button",{onClick:a,children:Object(D.jsx)(R.a,{icon:I.a})})]})]})})}),X=function(e){var t=e.match.params.userId,n=Object(c.useState)(null),r=Object(C.a)(n,2),a=r[0],i=r[1],s=Object(E.f)(),o=_();Object(c.useEffect)((function(){u()}),[]);var u=function(){var e=Object(g.a)(k.a.mark((function e(){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.get("/share/".concat(t)).then((function(e){return e.data.results}));case 3:n=e.sent,i(f({user:n})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),403===e.t0.response.status?o.logout():s.push("/home");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return a?Object(D.jsx)(L,{profile:a,visible:!0,onClose:function(){return s.push("/home")},onShare:function(){return a&&window.open("/share/".concat(a.id),"_blank")}}):Object(D.jsx)(D.Fragment,{})},A=function(){var e=Object(s.c)((function(e){return e.appReducer.logged})),t=Object(s.b)(),n=Object(E.f)(),r=_();Object(c.useEffect)((function(){a()}),[]);var a=function(){var e=Object(g.a)(k.a.mark((function e(){var c,a,i;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=new URLSearchParams(window.location.search),(a=c.get("token"))&&(window.localStorage.setItem("tashAppToken",a),window.location.href=window.location.origin+window.location.pathname),!window.localStorage.getItem("tashAppToken")){e.next=17;break}return e.prev=4,e.next=7,y.get("/me");case 7:i=e.sent,t(h.init(i.data)),"/"===n.location.pathname&&n.push("/home"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),r.logout();case 15:e.next=18;break;case 17:r.logout();case 18:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(){return e.apply(this,arguments)}}();return Object(D.jsxs)(D.Fragment,{children:[e&&Object(D.jsx)(T,{}),Object(D.jsx)("div",{className:"page",children:Object(D.jsxs)(E.c,{children:[Object(D.jsx)(E.a,{path:"/login",component:W,exact:!0}),Object(D.jsx)(E.a,{path:"/home",component:P,exact:!0}),Object(D.jsx)(E.a,{path:"/likes",component:U,exact:!0}),Object(D.jsx)(E.a,{path:"/share/:userId",component:X,exact:!0})]})})]})},Y=(n(95),function(){return Object(D.jsx)("div",{className:"tash-app",children:Object(D.jsx)(s.a,{store:x,children:Object(D.jsx)(M.a,{children:Object(D.jsx)(A,{})})})})}),H=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,100)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),a(e),i(e)}))};i.a.render(Object(D.jsx)(Y,{}),document.getElementById("root")),H()}},[[96,1,2]]]);
//# sourceMappingURL=main.d8df5649.chunk.js.map