(this.webpackJsonptash=this.webpackJsonptash||[]).push([[0],{87:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);var c,r,a=n(0),i=n(33),s=n.n(i),o=n(6),u=n(39),l=n(18),j=n(5),b=n(23),p=n(98),O=n(99);!function(e){e.VIEW="VIEW",e.ZOOM="ZOOM"}(c||(c={}));var f={logged:!1,user:{likesRemaining:0,ageFilterMax:0,ageFilterMin:0,pictures:[],name:""},profiles:[],stats:{showing:0,duplicates:0},viewer:{open:!1,mode:c.VIEW},likes:[],dislikes:[]},d=Object(p.a)({INIT:function(e){return{likesRemaining:e.likes.likes_remaining,ageFilterMax:e.user.age_filter_max,ageFilterMin:e.user.age_filter_min,pictures:e.user.photos.map((function(e){return e.url})),name:e.user.name}},PUSH:function(e){return e.map((function(e){var t=[],n=e.user.photos.map((function(e){return e.url}));return e.experiment_info&&t.push.apply(t,Object(b.a)(e.experiment_info.user_interests.selected_interests.map((function(e){return e.name})))),e.instagram&&e.instagram.photos&&n.push.apply(n,Object(b.a)(e.instagram.photos.map((function(e){return e.image})))),e.instagram&&console.log(e.instagram),{id:e.user._id,distance:(1.609*e.distance_mi).toFixed(1),sNumber:e.s_number,bio:e.user.bio,gender:e.user.gender,name:e.user.name,active:e.user.recently_active,birthDate:(new Date).getFullYear()-parseInt(e.user.birth_date.substr(0,4),10),interests:t,photos:n}}))},OPEN_VIEWER:function(){return null},CLOSE_VIEWER:function(){return null},CHANGE_VIEWER_MODE:function(e){return e},RESET_VIEWER:function(){return null},PUSH_LIKE:function(e){return e},PUSH_DISLIKE:function(e){return e}}),h=Object(O.a)((r={},Object(l.a)(r,d.init.toString(),(function(e,t){return Object(j.a)(Object(j.a)({},e),{},{user:t.payload,logged:!0})})),Object(l.a)(r,d.push.toString(),(function(e,t){var n=e.profiles.map((function(e){return e.id})),c=t.payload.filter((function(e){return-1===n.indexOf(e.id)}));return Object(j.a)(Object(j.a)({},e),{},{profiles:[].concat(Object(b.a)(e.profiles),Object(b.a)(c)),stats:{showing:e.profiles.length+c.length,duplicates:e.stats.duplicates+(t.payload.length-c.length)}})})),Object(l.a)(r,d.openViewer.toString(),(function(e){return Object(j.a)(Object(j.a)({},e),{},{viewer:Object(j.a)(Object(j.a)({},e.viewer),{},{open:!0})})})),Object(l.a)(r,d.closeViewer.toString(),(function(e){return Object(j.a)(Object(j.a)({},e),{},{viewer:{open:!1,mode:c.VIEW}})})),Object(l.a)(r,d.changeViewerMode.toString(),(function(e,t){return Object(j.a)(Object(j.a)({},e),{},{viewer:Object(j.a)(Object(j.a)({},e.viewer),{},{mode:t.payload})})})),Object(l.a)(r,d.resetViewer.toString(),(function(e){return Object(j.a)(Object(j.a)({},e),{},{viewer:Object(j.a)(Object(j.a)({},e.viewer),{},{mode:c.VIEW})})})),Object(l.a)(r,d.pushLike.toString(),(function(e,t){return Object(j.a)(Object(j.a)({},e),{},{likes:[].concat(Object(b.a)(e.likes),[t.payload])})})),Object(l.a)(r,d.pushDislike.toString(),(function(e,t){return Object(j.a)(Object(j.a)({},e),{},{dislikes:[].concat(Object(b.a)(e.dislikes),[t.payload])})})),r),f),m=Object(u.a)({appReducer:h}),v=Object(u.c)(m,{},Object(u.b)(window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__():function(e){return e})),x=n(9),g=n.n(x),k=n(16),w=n(4),E=n(43),N=n.n(E),S=N.a.create({baseURL:"http://".concat(window.location.hostname,":6382"),transformRequest:[].concat(Object(b.a)(N.a.defaults.transformRequest),[function(e,t){return t["tash-app-token"]||(t["tash-app-token"]=window.localStorage.getItem("tashAppToken")),e}])}),_=function(){window.localStorage.removeItem("tashAppToken"),window.location.href="/login"},I=n(8),y=n(7),M=n(38),R=n(26),V=(n(87),n(1)),D=function(){var e=Object(o.c)((function(e){return e.appReducer.viewer})),t=Object(o.b)();return Object(V.jsx)("div",{className:"sidebar",children:Object(V.jsxs)("ul",{children:[Object(V.jsx)("li",{children:Object(V.jsx)(R.b,{to:"/home",children:Object(V.jsx)(y.a,{icon:I.e})})}),Object(V.jsx)("li",{children:Object(V.jsx)(R.b,{to:"/likes",children:Object(V.jsx)(y.a,{icon:I.f})})}),e.open&&Object(V.jsx)("li",{children:Object(V.jsx)("a",{href:"#/",onClick:function(n){n.preventDefault(),t(d.changeViewerMode(e.mode===c.ZOOM?c.VIEW:c.ZOOM))},className:Object(M.a)({zoomActive:e.mode===c.ZOOM}),children:Object(V.jsx)(y.a,{icon:I.g})})})]})})},C=n(22),L=(n(90),function(e){var t=e.profile,n=e.visible,r=e.onClose,i=Object(o.c)((function(e){return e.appReducer.viewer})),s=Object(a.useState)(0),u=Object(C.a)(s,2),l=u[0],j=u[1],b=Object(o.b)(),p=Object(a.useState)(1),O=Object(C.a)(p,2),f=O[0],h=O[1],m=Object(a.useState)([0,0]),v=Object(C.a)(m,2),x=v[0],g=v[1],k=Object(a.useRef)(!1),w=Object(a.useRef)({x:0,y:0,tX:0,tY:0});Object(a.useEffect)((function(){b(d.resetViewer()),E()}),[l]),Object(a.useEffect)((function(){var e;return i.mode===c.ZOOM?n&&(e=document.querySelector(".viewer .preview"))&&e.addEventListener("mousewheel",N,!1):i.mode===c.VIEW&&E(),function(){e&&e.removeEventListener("mousewheel",N)}}),[i.mode]);var E=function(){h(1),g([0,0]),k.current=!1,w.current={x:0,y:0,tX:0,tY:0}},N=function(e){e.deltaY>0?h((function(e){return e>1?e-.1:e})):h((function(e){return e+.1}))},S=function(e){return j(e)};return n?Object(V.jsxs)("div",{className:"viewer",children:[Object(V.jsxs)("div",{className:"preview",onMouseMove:function(e){if(k.current){var t=e.pageX-70,n=e.pageY,c=w.current.x-t,r=w.current.y-n,a=[w.current.tX+c,w.current.tY+r];g(a)}},onMouseUp:function(e){e.preventDefault(),k.current?k.current=!1:"IMG"!==e.target.tagName&&r()},children:[Object(V.jsx)("button",{className:"prev",onMouseUp:function(e){e.preventDefault(),e.stopPropagation(),j((function(e){return 0===l?t.photos.length-1:e-1}))},children:Object(V.jsx)(y.a,{icon:I.b})}),Object(V.jsx)("img",{alt:"",src:t.photos[l],style:{transform:"scale(".concat(f,") translate(").concat(x[0],"px, ").concat(x[1],"px)")},onMouseDown:function(e){e.preventDefault();var t=document.querySelector(".viewer .preview");i.mode===c.ZOOM&&t&&(k.current=!0,g((function(t){return w.current={x:e.pageX-70,y:e.pageY,tX:t[0],tY:t[1]},t})))}}),Object(V.jsx)("button",{className:"next",onMouseUp:function(e){e.preventDefault(),e.stopPropagation(),j((function(e){return l===t.photos.length-1?0:e+1}))},children:Object(V.jsx)(y.a,{icon:I.c})})]}),Object(V.jsxs)("div",{className:"info",children:[Object(V.jsx)("button",{className:"close",onClick:r,children:Object(V.jsx)(y.a,{icon:I.h})}),Object(V.jsxs)("h1",{children:[t.name,", ",t.birthDate]}),Object(V.jsxs)("span",{className:"distance",children:[t.distance," km"]}),Object(V.jsx)("p",{children:t.bio}),Object(V.jsx)("div",{className:"gallery",children:t.photos.map((function(e,t){return Object(V.jsx)("img",{src:e,alt:"",className:Object(M.a)({active:t===l}),onClick:S.bind(null,t)},e)}))})]})]}):null}),T=(n(91),function(e){var t=e.profile,n=e.liked,c=e.disliked,r=Object(o.b)(),i=Object(a.useState)(!1),s=Object(C.a)(i,2),u=s[0],l=s[1],j=function(){var e=Object(k.a)(g.a.mark((function e(n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.stopPropagation(),e.prev=1,e.next=4,S.post("/like",{id:t.id,s:t.sNumber});case 4:200===e.sent.status&&r(d.pushLike(t.id)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),_();case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(k.a)(g.a.mark((function e(n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.stopPropagation(),e.prev=1,e.next=4,S.post("/dislike",{id:t.id,s:t.sNumber});case 4:200===e.sent.status&&r(d.pushDislike(t.id)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),_();case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)("div",{className:"profile",onClick:function(){l(!0),r(d.openViewer())},children:[Object(V.jsx)("img",{src:t.photos[0],alt:""}),Object(V.jsxs)("div",{className:"info",children:[Object(V.jsxs)("h2",{children:[t.name,", ",t.birthDate]}),Object(V.jsxs)("div",{className:"actions",children:[!n&&Object(V.jsx)("button",{className:"dislike",onClick:b,children:Object(V.jsx)(y.a,{icon:I.h})}),!c&&Object(V.jsx)("button",{className:"like",onClick:j,children:Object(V.jsx)(y.a,{icon:I.f})})]})]})]}),Object(V.jsx)(L,{profile:t,visible:u,onClose:function(){l(!1),r(d.closeViewer())}})]})}),F=(n(92),function(){var e=Object(o.c)((function(e){return e.appReducer})),t=e.profiles,n=e.likes,c=e.dislikes,r=Object(o.b)(),i=Object(a.useRef)(!0);Object(a.useEffect)((function(){u();var e=document.querySelector(".profiles");return e&&e.addEventListener("scroll",s,!1),function(){e&&e.removeEventListener("scroll",s)}}),[]);var s=function(e){!i.current&&e.target.scrollHeight-e.target.scrollTop<e.target.clientHeight+40&&u()},u=function(){var e=Object(k.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.current=!0,e.next=4,S.get("/profiles").then((function(e){return e.data.results}));case 4:t=e.sent,r(d.push(t)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),_();case 11:i.current=!1;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)("div",{className:"profiles",children:[t.map((function(e){return Object(V.jsx)(T,{profile:e,liked:-1!==n.indexOf(e.id),disliked:-1!==c.indexOf(e.id)},e.id)})),i.current&&Object(V.jsx)("div",{className:"loading",children:Object(V.jsx)(y.a,{icon:I.d,spin:!0})})]})}),W=(n(93),function(){var e=Object(a.useState)([]),t=Object(C.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(!1),i=Object(C.a)(r,2),s=i[0],o=i[1];Object(a.useEffect)((function(){u()}),[]);var u=function(){var e=Object(k.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o(!0),e.next=4,S.get("/likes").then((function(e){return e.data.results}));case 4:t=e.sent,c(t.map((function(e){return e.user.photos[0].url}))),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),_();case 11:o(!1);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)("div",{className:"likes",children:[n.map((function(e){return Object(V.jsx)("div",{className:"like",children:Object(V.jsx)("img",{src:e,alt:""})},e)})),s&&Object(V.jsx)("div",{className:"loading",children:Object(V.jsx)(y.a,{icon:I.d,spin:!0})})]})}),P=(n(94),function(){var e=Object(a.useRef)(null),t=Object(o.b)(),n=Object(w.f)(),c=function(){var c=Object(k.a)(g.a.mark((function c(){var r;return g.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(!e.current||!e.current.value){c.next=13;break}return c.prev=1,c.next=4,S.get("/me",{headers:{"tash-app-token":e.current.value}});case 4:r=c.sent,window.localStorage.setItem("tashAppToken",e.current.value),t(d.init(r.data)),n.push("/home"),c.next=13;break;case 10:c.prev=10,c.t0=c.catch(1),alert("Invalid");case 13:case"end":return c.stop()}}),c,null,[[1,10]])})));return function(){return c.apply(this,arguments)}}();return Object(V.jsx)("div",{className:"login-page",children:Object(V.jsxs)("div",{className:"box",children:[Object(V.jsx)("h1",{children:"TASH"}),Object(V.jsxs)("div",{className:"auth",children:[Object(V.jsx)("input",{ref:e,name:"token"}),Object(V.jsx)("button",{onClick:c,children:Object(V.jsx)(y.a,{icon:I.a})})]})]})})}),X=function(){var e=Object(o.c)((function(e){return e.appReducer.logged})),t=Object(o.b)(),n=Object(w.f)();Object(a.useEffect)((function(){c()}),[]);var c=function(){var e=Object(k.a)(g.a.mark((function e(){var c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.localStorage.getItem("tashAppToken")){e.next=14;break}return e.prev=1,e.next=4,S.get("/me");case 4:c=e.sent,t(d.init(c.data)),"/"===n.location.pathname&&n.push("/home"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),_();case 12:e.next=15;break;case 14:n.push("/login");case 15:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();return Object(V.jsxs)(V.Fragment,{children:[e&&Object(V.jsx)(D,{}),Object(V.jsx)("div",{className:"page",children:Object(V.jsxs)(w.c,{children:[Object(V.jsx)(w.a,{path:"/login",component:P,exact:!0}),Object(V.jsx)(w.a,{path:"/home",component:F,exact:!0}),Object(V.jsx)(w.a,{path:"/likes",component:W,exact:!0})]})})]})},U=(n(95),function(){return Object(V.jsx)("div",{className:"tash-app",children:Object(V.jsx)(o.a,{store:v,children:Object(V.jsx)(R.a,{children:Object(V.jsx)(X,{})})})})}),Y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,100)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};s.a.render(Object(V.jsx)(U,{}),document.getElementById("root")),Y()}},[[96,1,2]]]);
//# sourceMappingURL=main.dbed3ab4.chunk.js.map